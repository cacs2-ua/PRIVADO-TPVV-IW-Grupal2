<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Pagos del Comercio</title>

  <link rel="stylesheet" th:href="@{/css/custom/listadoPagosComercioStyle.css}">
  <div th:include="fragments :: head (titulo='Pagos del Comercio')"></div>
</head>
<body class="body-background">
<div th:replace="fragments::menuBar"></div>
<div class="container">
  <h1 class="title">Pagos del Comercio</h1>
  <form class="busqueda">
    <label>Id</label>
    <label>Ticket</label>
    <label>Estados</label>
    <label>Fecha Desde</label>
    <label>Fecha Hasta</label>
    <label></label>
    <input type="text" class="search-input">
    <input type="text" class="search-input">
    <select class="search-select">
      <option selected>Todos</option>
      <option>Aceptado</option>
      <option>Pendiente</option>
      <option>Rechazado</option>
    </select>
    <input type="date" class="search-input">
    <input type="date" class="search-input">
    <button type="submit">Aplicar filtros</button>
  </form>

  <div class="table-container">
    <table class="data-table">
      <thead>
      <tr>
        <th>#</th>
        <th>Fecha</th>
        <th>Ticket</th>
        <th>Importe</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
      </thead>
      <tbody>
      <!-- NUEVO o MODIFICADO: Borrar o comentar las filas estáticas y usar Thymeleaf para iterar. -->
      <tr th:each="p : ${pagos}">  <!-- NUEVO o MODIFICADO -->
        <!-- NUEVO o MODIFICADO: Se muestra el ID -->
        <td th:text="${p.id}"></td>

        <!-- NUEVO o MODIFICADO:
             Se formatea la fecha usando #temporals.format(p.fecha, 'dd/MM/yyyy HH:mm').
             Asegúrate de que tu config de Thymeleaf incluya las utilidades de fecha
             o ajusta este formato a tu conveniencia.
        -->
        <td th:text="${p.fecha}"></td>


        <!-- NUEVO o MODIFICADO: Ticket -->
        <td th:text="${p.ticketExt}"></td>

        <!-- NUEVO o MODIFICADO: Importe, añadiendo el símbolo de euro -->
        <td th:text="${p.importe + '€'}"></td>

        <!-- NUEVO o MODIFICADO:
             Se muestra el estado y se añade una clase condicional para colorearlo:
             Aceptado => 'status-active'
             Pendiente => 'status-pending'
             Rechazado => 'status-inactive'
        -->
        <td th:text="${p.shownState}"
            th:classappend="${p.shownState == 'Aceptado' ? 'status-active' :
                    (p.shownState == 'Pendiente' ? 'status-pending' :
                    'status-inactive')}">
        </td>


        <!-- NUEVO o MODIFICADO: Botón de Detalles (enlaza con un detalle hipotético) -->
        <td>
          <a th:href="@{'/api/comercio/pagos/' + ${p.id}}" class="btn btn-info">Detalles</a>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>

<div th:replace="fragments::javascript"></div>
</body>
</html>
